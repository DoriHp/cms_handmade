<!DOCTYPE html>
<html lang="vi">
<head>
	<title>Bot CMS</title>
	<meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="/css/style.css">	
	<meta name="viewport" content="width = device-width, initial-scale = 1, shrink-to-fit = no">
	<meta name="theme-color" content="#574E4E">
	<meta name="msapplication-TileColor" content="#574E4E">
	<meta name="msapplication-navbutton-color" content="#574E4E">
	<meta name="apple-mobile-web-app-status-bar-style" content="#574E4E">
	<link rel="shortcut icon" href="/image/image.jpg">
	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
	<script type="text/javascript" scr="script.js"></script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Quicksand" rel="stylesheet">
	<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
</head>
<body>
	<header>
		<h1 class="display-4">BotkitCMS</h1>
	</header>
	<div class="container">
		<div class="row" id='div_button'>
			<div class="btn-group" role="group" aria-label="Button">
				<button type="button" class="btn btn-secondary btn-info" onclick="window.location.href='/'">Danh sách</button>
				<button type="button" class="btn btn-secondary btn-toolbar" onclick="window.location.href='/script/add/question'">Thêm script</button>
				<button type="button" class="btn btn-secondary btn-warning" onclick="window.location.href='/broadcast'">Tin nhắn hàng loạt</button>
			</div>
		</div>
		<div class="row">
			<div id='div_table' class="col-12">
				<table class="table table-striped table-bordered table-sm" id='table_body' cellspacing="0" width="100%">
					<thead>
						<tr>
							<th>Script ID</th>
							<th>Description</th>
							<th>Intent</th>
							<th>Script type</th>
						</tr>
					</thead>
					<tbody>
					</tbody>
				</table>		
			</div>
		</div>
	</div>
	<script type="text/javascript">
		// location.hash = "main"
		(function(){
			axios.get('/script',{
				headers:{
					'Content-Type': 'application/json',
					}
				}).then(function(response){
					var a = JSON.stringify(response.data)
					showOut(a)
				}).catch(function(error){
					console.log(error)
				})
		})()

		function showOut(items){
			var table_body = document.getElementById('table_body')
			var a = JSON.parse(items)
			var index = 0
			for(let i of a){
				let row = table_body.insertRow(index + 1)
				
				var cell0 = row.insertCell(0)
				var cell1 = row.insertCell(1)
				var cell2 = row.insertCell(2)
				var cell3 = row.insertCell(3)
				
				cell0.innerHTML = (i.id == undefined)?"N/A":i.id
				cell1.innerHTML = (i.description == undefined)?"N/A":i.description
				cell2.innerHTML = (i.type == undefined)?"N/A":i.type
				cell3.innerHTML = (i.script.type == undefined)?"N/A":i.script.type

				row.addEventListener('click', getProperties)

				index++
				
			}
		}

		function getProperties(e){
			var id = this.querySelectorAll("*")[0].innerHTML.trim()
			window.open('http://localhost:5000/script/properties/' + encodeURIComponent(id), '_blank')
		}
	</script>
</body>
</html>